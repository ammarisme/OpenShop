<div class="col-md-12">
    <!-- Modal -->
    <div class="modal fade" id="myModal" role="dialog" data-backdrop="false">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">Close</button>
                    <h4 class="modal-title"></h4>
                </div>
                <div class="modal-body">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
                </div>
            </div>

        </div>
    </div>
</div>
@* Payment Creation Form *@
<div class="col-md-6 col-sm-12">
    <form action="/api/SalaryPayments/AddSalaryPayment" id="salary-payment-form" method="POST">
        <div id="name-group" class="form-group">
                        @*
                autogenerated :
                SalaryPaymentId    
                        *@

            @*EmployeeId*@
            <label for="name">Employee</label>
            @Html.DropDownList("EmployeeId", new SelectList(ViewBag.employees, "EmployeeId", "EmployeeFullName"), htmlAttributes: new { @class = "form-control", id = "EmployeeId" })

            @*Amount*@
            <label for="date">Amount</label>
            <input type="number" pattern="[0-9.]+" name="Amount" class="form-control" />

            @*PaidDate*@
            <label for="date">PaidDate</label>
            <input type="date" name="PaidDate" class="form-control" />

            @*Remark*@
            <label for="name">Remark</label>
            <input type="text" name="Remark" class="form-control" />
        </div>
    <button class="btn btn-success" id="create-salary-payment-button">Make Salary Payment</button>
    </form>
</div>

@* show the payment list from the database *@
<div class="col-md-12 col-sm-12">
    <table id="salary-payments-table" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>SalaryPaymentId</th>
                <th>Amount</th>
                <th>EmployeeId</th>
                <th>PaidDate</th>
                <th>Remark</th>
            </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
            <tr>
                <th>SalaryPaymentId</th>
                <th>Amount</th>
                <th>EmployeeId</th>
                <th>PaidDate</th>
                <th>Remark</th>
            </tr>
        </tfoot>
    </table>
</div>


<script src="~/Scripts/bootstrap-datetimepicker.min.js"></script>
<script>
    viewControllerRoute = "../SalaryPayments/CreateViewSalaryPayments"; // where the user is in

    /// Initiating the salary payments table

    var salaryPaymentsTable = $("#salary-payments-table").DataTable({
        "columns": [
                { "data": "SalaryPaymentId" },
                { "data": "Amount" },
                { "data": "EmployeeId" },
                { "data": "PaidDate" },
                { "data": "Remark" },
        ]
    });
    
    updateTableFromApi(salaryPaymentsTable, "/api/SalaryPayments/GetSalaryPayments", function () { });

    $("#salary-payment-form").on('submit', function (event) {
        var FormData = getFormValues('salary-payment-form');
        $.ajax({
            type: 'post',
            url: "/api/SalaryPayments/AddSalaryPayment",
            data: JSON.stringify(FormData),
            dataType: 'json',
            contentType: 'application/json',
            success: function (data) {
                salaryPaymentsTable.clear();
                updateTableFromApi(salaryPaymentsTable, "/api/SalaryPayments/GetSalaryPayments", function () { });
            }
        }
            );
            event.preventDefault();
    });

</script>